---
title: "Extrem-Alpinisten"
output: html_notebook
---

```{r Erstellt unser Netzwerk, message=FALSE, warning=FALSE, paged.print=TRUE}
library(igraph)
el <- read.csv("https://raw.githubusercontent.com/lw088/Extemalpinisten/master/edgelist_extremalpinisten.csv", header=T, as.is=T, sep=",")
nodes <- read.csv("https://raw.githubusercontent.com/lw088/Extemalpinisten/master/nodelist_extremalpinisten.cvs", header=T, as.is=T, sep=",")
ea_matrix <- as.matrix(el)
ea <- graph_from_data_frame(d=ea_matrix, vertices=nodes, directed=FALSE)
list.edge.attributes(ea)
```

Analyse: ungerichtetet two-mode Netzwerk mit 154 Knoten und 224 Kanten
```{r}
is.simple(ea)
```


```{r Attribute analysieren, message=FALSE, warning=FALSE}
list.edge.attributes(ea)
list.vertex.attributes(ea)
```

Problem: Ihre Attribute relation, awardyear und deathyear sind nicht numerisch kodiert.



```{r Visualisierungen definieren}
#Farben für Geschlecht und Berg
V(ea)[V(ea)$sex == 1]$color <- "pink" #weiblich
V(ea)[V(ea)$sex == 2]$color <- "lightblue" #maennlich
V(ea)[V(ea)$sex == 3]$color <- "lightgreen" #divers
V(ea)[V(ea)$sex == 99]$color <- "grey80" #Berg

#Form für Menschen und Berge festlegen
V(ea)[V(ea)$type == 1]$shape <- "circle" #Mensch
V(ea)[V(ea)$type == 2]$shape <- "square" #Berg
```
Hier ist nur die Visualisierung definiert worden. 

```{r Visualisierung Gesamtnetzwerk, fig.height=10, fig.width=16}
plot(ea,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=10,
     vertex.frame.color=NA,
     edge.arrow.size=.7,
     edge.color="black", 
     main ="Übersicht Gesamtnetzwerk",
     sub="Grau - Berg; Hellblau - Männer, Rosa - Frauen, Grün - Expeditionen")
```
Das Gesamtnetzwerk ist geplottet, alle Knoten sind gleich gewichtet, es werden ausschließlich Beziehungen angezeigt.

```{r Teilnetzwerk Seilschaften}
#Auflisten der Kletterer in Beziehungen zueinandder
ea
list.vertex.attributes(ea)
vertex.attributes(ea)$nationality
#Filtern nach nur Kletterern ohne Berge, nationality 99 rausfiltern, damit keine Bergen gezeigt werden; se = Seilschaften
se<- delete_vertices(ea, V(ea)[nationality == "99"])


#Plot nach Beziehungen
plot(se,
     layout=layout_with_kk,
     edge.arrow.size=.3,
     main="Alle Kletterer",
     vertex.size=degree(se, mode="all")*3,
     vertex.label.dist=.8,
     vertex.label.degree=0,
     vertex.label.cex=.6,
     vertex.label.family="Helvetica",
     vertex.label.font=2,
     vertex.label.color="black"
     #vertex.label=NA,
     #vertex.frame.color=NA
     )

#Isloierte Gruppen (2er) ausgefiltert
iso_se <- which(degree(se)<=1)
se_clean <- delete.vertices(se, iso_se)


plot(se_clean,
     layout=layout_with_kk,
     edge.arrow.size=.3,
     main="Alle Kletterer ohne Isolationsbeziehungen",
     vertex.size=degree(se_clean, mode="all")*3,
     vertex.label.dist=.8,
     vertex.label.degree=0,
     vertex.label.cex=.6,
     vertex.label.family="Helvetica",
     vertex.label.font=2,
     vertex.label.color="black",
     #vertex.label=NA,
     #vertex.frame.color=NA
     )
```
Analyse: Hayden Kennedy und Marko Perzelj scheinen Verbindungsakteure zweier Gruppen (Nationen) zu sein. Wir fokussieren uns auf die Ego-Netzwerke der beiden Akteuren, um sie genauer zu analysieren. Dabei betrachten wir insbesondere die Verbindung der Nationen.

```{r Egonetzwerk Hayden Kennedy}
#Ego Netzwerk erstellen Hayden Kennedy 
ego_hake <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Hayden Kennedy", mode="all")
ego_hake1 <- ego_hake[[1]]

#2 Siege sind auch 2 unterschiedliche Nationalitäten?
#V(ea)[V(ea)$nationality == 4]$frame.color <- "red" #Amerikaner
#V(ea)[V(ea)$nationality == 10]$frame.color <- "darkblue" #Slowenien
#V(ea)[V(ea)$nationality == 6]$frame.color <- "orange" #Frankreich


#Netzwerk plotten, Verbindung zweier Gruppen durch zwei Siege mit zwei Gruppen ist bestätigt, die Nationen sind gemischt, nicht nur 2 Gruppen sonder A) Amerikaner und B) Slowenien, Frankreich und Amerika

plot(ego_hake1,
      layout=layout_with_kk,
      main="Egonetzwerk Hayden Kennedy",
      edge.arrow.size=.3,
      vertex.size=degree(ego_hake1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )


```
Analyse: Wir sehen, dass Hayden Kennedy mit zwei unterschiedlichen Gruppen 2 Siege an Bergen eingeholt hat. Die eine Gruppe besteht ausschließlich aus Amerikanern. Gruppe zwei ist durchmischt. Frankreich, Slowenien und Amerika haben Cerro Kishtwar zusammen bestiegen. Kennedy scheint also mit allen Nationalitäten zu klettern.

```{r Egonetzwerk Hayden Kennedy mit Freundesfreunden}
#Ego Netzwerk erstellen Hayden Kennedy mit seinen Freundesfreunden
ego_hake <- make_ego_graph(ea, order=2, nodes= V(ea)$name=="Hayden Kennedy", mode="all")
ego_hake1 <- ego_hake[[1]]

#2 Siege sind auch 2 unterschiedliche Nationalitäten?
#V(ea)[V(ea)$nationality == 4]$frame.color <- "red" #Amerikaner
#V(ea)[V(ea)$nationality == 10]$frame.color <- "darkblue" #Slowenien
#V(ea)[V(ea)$nationality == 6]$frame.color <- "orange" #Frankreich



#Netzwerk plotten, Verbindung zweier Gruppen durch zwei Siege mit zwei Gruppen ist bestätigt, die Nationen sind gemischt, nicht nur 2 Gruppen sonder A) Amerikaner und B) Slowenien, Frankreich und Amerika

plot(ego_hake1,
      layout=layout_with_kk,
      main="Egonetzwerk Hayden Kennedy mit Beziehungen zweiter Generation",
      edge.arrow.size=.3,
      vertex.size=degree(ego_hake1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )

```
Analyse: Wir können sehen, dass Kennedy tatsächlich das Verbindungsstück zweier Nationen ist - auch wenn Marko Prezelj eine große Community bildet, besteht diese nur aus Sloewnene und schafft daher kein internationales Nwetzwerk. 

```{r Der erfolgreichste Kletterer}


#Beziehungen unter Personen und Todesbergen werden gelöscht
sg_ek <-subgraph.edges(ea, E(ea)[relation=="1"])

#Netzwerk Personen mit Bergen plotten
plot(sg_ek,
     layout=layout_with_kk,
     vertex.label.color="black",
     vertex.label.family="Helvetica",
     vertex.label=NA,
     vertex.frame.color="black",
     edge.color="grey20",
     main = "Visualisierung Gesamtnetzwerk nur Personen mit Bergen in Beziehung",
     )

#Filtern nach größtem degree- Wert in Beziehungen von Personen zu Bergen

# Einfache Berechnung des Degree als Gesamtwert
dea <- degree(sg_ek)
dea


plot(sg_ek,
     layout=layout_with_kk,
     vertex.size=dea*5,
     vertex.label.color="black",
     vertex.label.family="Helvetica",
     vertex.label.size="2",
     #vertex.label=NA,
     vertex.frame.color=NA,
     edge.color="grey20",
     main = "Gesamtnetzwerk Mensch und Berg")


```
Analyse: Wir berücksichtigen die degree Werte der Berge in diesem Zusammenhang erstmal nicht. Die höchsteh der degree Werte der Personen haben Paul Ramsden und Marko Prezelj. In folgenden Egonetzwerken sollen die beiden Personen gegenübergestellt werden.

```{r Egonetzwerke Paul Ramsden und Marko Prezelj und Bestimmung degree Wert}

#Ego Netzwerk erstellen Paul Ramsden
ego_para <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Paul Ramsden", mode="all")
ego_para1<- ego_para[[1]]

#relations Farbe geben

E(ego_para1)[E(ego_para1)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_para1)[E(ego_para1)$relation == 3]$color <- "black" #Seilschaft

#Netzwerk plotten
plot(ego_para1,
      layout=layout_with_kk,
      main="Egonetzwerk Paul Ramsden",
      edge.arrow.size=.3,
      vertex.size=degree(ego_para1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )
#Ego Netzwerk erstellen Marko Prezelj
ego_mapr <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Marko Prezelj", mode="all")
ego_mapr1<- ego_mapr[[1]]

#relations Farbe geben

E(ego_mapr1)[E(ego_mapr1)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_mapr1)[E(ego_mapr1)$relation == 3]$color <- "black" #Seilschaft

plot(ego_mapr1,
      layout=layout_with_kk,
      main="Egonetzwerk Marko Prezelj",
      edge.arrow.size=.3,
      vertex.size=degree(ego_mapr1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )

```
Analyse: Sowohl Paul Ramsen alsauch Marko Prezelj haben jeweils 4 Berge erfolgreich bestiegen und den Piolets D'Or gewonnen. Somit sind die beiden die erfolgreichsten KLetterer, die mit diesem Preis ausgezeichnet worden sind!
Hinweis: Beziehung von Marko Prezelj zu Cerro Kishtwar ist Schwarz, wissen nicht wieso, in Nodelist richtig, müsste eigentlich Grün sein!

```{r beliebtester Berg Egonetzwerk Kamet}

#Egonetzwerk Kamet
dea <- degree (ea)
dea

which.max(dea)

ego_b20 <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Kamet", mode="all")
ego_b201<- ego_b20[[1]]

E(ego_b201)[E(ego_b201)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_b201)[E(ego_b201)$relation == 2]$color <- "red" #Todesberg
E(ego_b201)[E(ego_b201)$relation == 3]$color <- "black" #Seilschaft

plot(ego_b201,
      layout=layout_with_kk,
      main="Egonetzwerk Berg Kamet",
      edge.arrow.size=.3,
      vertex.size=degree(ego_b201, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )


#Egonetzwerk Ogre

ego_b07 <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Ogre", mode="all")
ego_b071<- ego_b07[[1]]

E(ego_b071)[E(ego_b071)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_b071)[E(ego_b071)$relation == 2]$color <- "red" #Todesberg
E(ego_b071)[E(ego_b071)$relation == 3]$color <- "black" #Seilschaft

plot(ego_b071,
      layout=layout_with_kk,
      main="Egonetzwerk Berg Ogre",
      edge.arrow.size=.3,
      vertex.size=degree(ego_b201, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )


#Egonetzwerk Thalay Sagar

ego_b33 <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Thalay Sagar", mode="all")
ego_b331<- ego_b33[[1]]

E(ego_b331)[E(ego_b331)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_b331)[E(ego_b331)$relation == 2]$color <- "red" #Todesberg
E(ego_b331)[E(ego_b331)$relation == 3]$color <- "black" #Seilschaft

plot(ego_b331,
      layout=layout_with_kk,
      main="Egonetzwerk Berg Thalay Sagar",
      edge.arrow.size=.3,
      vertex.size=degree(ego_b331, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )
```
Analyse: Wir konnten erkennen, dass der Kamet der Berg ist,mit den meisten Besteigungen und Siegen, wobei zu bemerken ist, dass es sich beide Male um Seilschaften handelt, tatsächlich also nur zwei Gruppen den Berg bestiegen haben. Ogre und Thalay Sagar haben beide 5 Degrees. Ogre ist dabei mit zwei Todesfällen sehr auffällig.

```{r Todesberge und die Verünglückten}

# Teilnetzwerke nach Beziehungen relation=2 Todesberge
sg_tb <-subgraph.edges(ea, E(ea)[relation=="2"])

E(sg_tb)[E(sg_tb)$relation == 2]$color <- "black" #Todesberg

#Netzwerk plotten
plot (sg_tb,
      layout=layout_with_fr,
      main="Todesberge und Verunglückte",
      edge.arrow.size=.3,
      vertex.size=degree(sg_tb, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black"
      )
    

#Egonetzwerk Howse Peak

ego_b50 <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Howse Peak", mode="all")
ego_b501<- ego_b50[[1]]

E(ego_b501)[E(ego_b501)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_b501)[E(ego_b501)$relation == 2]$color <- "red" #Todesberg
E(ego_b501)[E(ego_b501)$relation == 3]$color <- "black" #Seilschaft

plot(ego_b501,
      layout=layout_with_kk,
      main="Egonetzwerk Berg Howse Peak",
      edge.arrow.size=.3,
      vertex.size=degree(ego_b501, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )
```
Analyse: Insgesamt sind 12 der Preisträger an einem Bergunglück gestorben, drei davon an dem Howse Peak. Er scheint somit einer der schwierigsten und tödlichsten Berge zu sein. An dem Howse Peak wurdenoch nie ein Piolet Dòr gewonnen.


```{r Die Nation mit den meisten unterschiedlichen Siegern fig.height=6, fig.width=10, warning=FALSE, paged.print=FALSE}
#Beziehungen von Personen zu Bergen bei denen Sie nicht gewonnen haben werden gelöscht
sg_en <-subgraph.edges(ea, E(ea)[relation=="1"])

#Die Namen werden gegen die ID Nation getauscht angezeigt, uns interessiert nur die Nationalität
V(sg_en)$label <- V(sg_en)$nationality

#Netzwerk plotten
plot(sg_en,
      layout=layout_with_kk,
      main="Nationen und Berge",
      edge.arrow.size=.3,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )

#Berge entfernen
ea_na<- delete_vertices(sg_en, V(sg_en)[type== 2])

ea_na
list.vertex.attributes(ea_na)
vertex.attributes(ea_na)$nationality

#Herausfiltern, wie viel Kletterer pro Nation
V(ea_na)[V(ea_na)$nationality == 4]$color <- "red" #Amerikaner
V(ea_na)[V(ea_na)$nationality == 10]$color <- "blue" #Slowenien
V(ea_na)[V(ea_na)$nationality == 7]$color <- "yellow" #Japan
V(ea_na)[V(ea_na)$nationality == 6]$color <- "orange" #Franzosen

#Netzwerk plotten
plot(ea_na,
      layout=layout_with_fr,
      main="Nationen, mit den meisten unterschiedlichen Siegern",
      edge.arrow.size=.3,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      sub= "Orange-Frankreich; Dunkelblau-Slowenien; Rot-Amerika; Gelb-Japan; Hellblau-Andere"
      )

```
Analyse: Frankreich hat mit 16 unterschiedlichen Siegern die am breitest aufgestellte Kletterfraktion. Dicht gefolgt von den Amerikanern mit 14 unterschiedlichen Siegern, den Japanern mit 11 und den Slowenen mit 10. Interessant ist nun herauszufinden, ob die vier Nationen gleichzeitig zu den Nationen mit den meisten Siegen insgesamt, unabhängig von der Person, gehören. 

```{r Wer ist unter den Franzosen der Player, fig.height=6, fig.width=10, warning=FALSE, paged.print=FALSE}


fr <- delete_vertices(ea, V(ea)[nationality!= "6" & nationality!= "99"])
fr <- delete_vertices(ea, V(ea)[nationality!= "6" & nationality!= "99"])
sg_fr <-subgraph.edges(fr, E(fr)[relation!="2"])


# Berge mit degree =0 löschen
iso_fr <- which(degree(sg_fr)<=1)
fr_clean <- delete.vertices(fr, iso_fr)

# Netzwerk französische Seilschaften und bestiegene Gewinnerberge

plot(fr_clean,
     layout=layout_with_fr,
     edge.arrow.size=.3,
     main="Französische Alpinisten mit bestiegenen Bergen",
     vertex.size=degree(fr_clean, mode="all")*5,
     vertex.label.dist=.8,
     vertex.label.degree=0,
     vertex.label.cex=.6,
     vertex.label.family="Helvetica",
     vertex.label.font=1,
     vertex.label.color="black",
     #vertex.label=NA,
     #vertex.frame.color=NA,
     sub="blau=männlich pink=weiblich grau=Berg")


```
Franzosen sind eine breit gefächerte Siegernation. Jedoch sind alle Siege einmalige Siege. Im Vergleich haben die erfolgreichsten Kletterer generell viermal gewonnen, siehe Paul Ramsden (England) und Marko Prezelj (Slowenien).
Sind demnach Slowenien und England, insbesondere Slowenien nicht die heimlichen Siegernation in Bezug auf die Anzahl der Gewinne. Denn nach dem obrigen Schaubild sind die Franzosen nur die Nation mit den meisten Preisträgern.



```{r Teilnetzwerk Frauen}

vertex.attributes(ea)$sex
ea_fem <- delete_vertices(ea, V(ea)[sex != 1])
ea_fem
plot(ea_fem,
     layout=layout_with_kk,
     edge.arrow.size=.3,
     main="Extremalpinisten (weiblich)",
     vertex.color="pink",
     vertex.size=50,
     vertex.frame.color= "black",
     vertex.label.color= "black",
     sub="pink=weiblich grau=Berg")

#Egonetzwerk Kei Tangiguchi

ego_teka <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Kei Tangiguchi", mode="all")
ego_keta1<- ego_keta[[1]]

E(ego_keta1)[E(ego_keta1)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_keta1)[E(ego_keta1)$relation == 2]$color <- "red" #Todesberg
E(ego_keta1)[E(ego_keta1)$relation == 3]$color <- "black" #Seilschaft

plot(ego_keta1,
      layout=layout_with_kk,
      main="Egonetzwerk Kei Tangiguchi",
      edge.arrow.size=.3,
      vertex.size=degree(ego_keta1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )

#Egonetzwerk Lise Billon

ego_libi <- make_ego_graph(ea, order=1, nodes= V(ea)$name=="Lise Billon", mode="all")
egolibi1<- ego_libi[[1]]

#Farben für Geschlecht und Berg
V(ego_libi1)[V(ego_libi1)$sex == 1]$color <- "pink" #weiblich
V(ego_libi1)[V(ego_libi1)$sex == 2]$color <- "lightblue" #maennlich
V(ego_libi1)[V(ego_libi1)$sex == 3]$color <- "lightgreen" #divers
V(ego_libi1)[V(ego_libi1)$sex == 99]$color <- "grey80" #Berg

#Form für Menschen und Berge festlegen
V(ego_libi1)[V(ego_libi1)$type == 1]$shape <- "circle" #Mensch
V(ego_libi1)[V(ego_libi1)$type == 2]$shape <- "square" #Berg

E(ego_libi1)[E(ego_libi1)$relation == 1]$color <- "green" #Gewinnerberg
E(ego_libi1)[E(ego_libi1)$relation == 2]$color <- "red" #Todesberg
E(ego_libi1)[E(ego_libi1)$relation == 3]$color <- "black" #Seilschaft


plot(ego_libi1,
      layout=layout_with_kk,
      main="Egonetzwerk Lise Billon",
      edge.arrow.size=.3,
      vertex.size=degree(ego_libi1, mode="all")*5,
      vertex.label.degree=0,
      vertex.label.dist=.8,
      vertex.label.cex=.60,
      vertex.label.font=1,
      vertex.label.color="black",
      )

```

Interpretation: Unter den Gewinnern sind nur zwei Frauen, die jeweils auch keinen Kontakt zueinander haben. Unter Piolets d'or gewinnern gibt es keine Verbindung zwischen Siegerinnen. Der Klettersport im Profibereich scheint außerdem Männern vorbehalten zu sein. Außerdem liegt die Todesquote bei Frauen, die den Piolets D'or gewonnen haben, bei 50 Prozent. Das ist natürlich kein repräsentatives Ergebnis, dennoch aber interessant zu beobachten. 

```{r Nationen und Seilschaften}
#Auflisten der Kletterer in Beziehungen zueinandder
ea
list.vertex.attributes(ea)
vertex.attributes(ea)$nationality

#Filtern nach nur Kletterern ohne Berge, nationality 99 rausfiltern, damit keine Bergen gezeigt werden; nase = NationenundSeilschaften
nase<- delete_vertices(ea, V(ea)[nationality == "99"])


#Isloierte Gruppen (2er) ausgefiltert
iso_nase <- which(degree(nase)<=1)
nase_clean <- delete.vertices(nase, iso_nase)

V(nase_clean)[V(nase_clean)$nationality == 1]$color <- "green" #Österreich
V(nase_clean)[V(nase_clean)$nationality == 3]$color <- "black" #Schweiz
V(nase_clean)[V(nase_clean)$nationality == 4]$color <- "red" #Amerikaner
V(nase_clean)[V(nase_clean)$nationality == 6]$color <- "orange" #Franzosen
V(nase_clean)[V(nase_clean)$nationality == 7]$color <- "yellow" #Japan
V(nase_clean)[V(nase_clean)$nationality == 8]$color <- "brown" #Russland
V(nase_clean)[V(nase_clean)$nationality == 9]$color <- "purple" #England
V(nase_clean)[V(nase_clean)$nationality == 10]$color <- "blue" #Slowenien
V(nase_clean)[V(nase_clean)$nationality == 12]$color <- "white" #Norwegen
V(nase_clean)[V(nase_clean)$nationality == 14]$color <- "pink" #Argentinien
V(nase_clean)[V(nase_clean)$nationality == 17]$color <- "grey" #Schottland

plot(nase_clean,
     layout=layout_with_kk,
     edge.arrow.size=.3,
     main="Alle Kletterer ohne Isolationsbeziehungen",
     vertex.size=degree(nase_clean, mode="all")*3,
     vertex.label.dist=.8,
     vertex.label.degree=0,
     vertex.label.cex=.6,
     vertex.label.family="Helvetica",
     vertex.label.font=2,
     vertex.label.color="black",
     #vertex.label=NA,
     #vertex.frame.color=NA
     )
```
Analyse: Vermehrt wird mit der eigenen Nation geklettert. In nur 4 von 12 Netzwerken mischen sich die Nationen, die restlichen 8 sind mit der eigenen Nation unterwegs. Außerdem ist interessant zu sehen, dass es einige Nationen gibt, die garnicht gemeinsam klettern, die Siege beim Piolets D'or zu zweit oder alleine geholt haben. 2,5,11,13,15,16 Klettern nicht in größeren Gruppen. 

```{r Solokletterer}
#Erstellung nur Mensch Gewinnerberge Beziehungen
solo<- subgraph.edges(ea, E(ea)[relation =="1"])


#Personen mit einem Degree oder weniger werden gefiltert
iso_solo <- which(degree(solo)>=1)
solo_clean <- delete.vertices(solo, iso_solo)


plot(solo_clean,
     layout=layout_with_kk,
     edge.arrow.size=.3,
     main="Solokletterer",
     vertex.label.dist=.8,
     vertex.label.degree=0,
     vertex.label.cex=.6,
     vertex.label.family="Helvetica",
     vertex.label.font=2,
     vertex.label.color="black",
     #vertex.label=NA,
     #vertex.frame.color=N
     )
```


```

